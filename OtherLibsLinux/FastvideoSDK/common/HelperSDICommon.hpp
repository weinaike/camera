#pragma once

#include "fastvideo_sdk_define.h"

inline unsigned long GetSDIValueSize(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_YV12_BT709:
		case FAST_SDI_YV12_BT2020:
		case FAST_SDI_YV12_BT601:
		case FAST_SDI_YV12_BT601_FR:

		case FAST_SDI_420_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT2020:
		
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_NV12_BT709:
		case FAST_SDI_NV12_BT2020:
		case FAST_SDI_NV12_BT601:
		case FAST_SDI_NV12_BT601_FR:

		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:

		case FAST_SDI_444_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT2020:
		{
			return sizeof(unsigned char);
		}

		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT601_FR:
		
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return sizeof(unsigned short);
		}
	}

	return 0;
}

inline unsigned long GetSDIWidthAlignValue(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_YV12_BT709:
		case FAST_SDI_YV12_BT2020:
		case FAST_SDI_YV12_BT601:
		case FAST_SDI_YV12_BT601_FR:

		case FAST_SDI_420_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_NV12_BT709:
		case FAST_SDI_NV12_BT2020:
		case FAST_SDI_NV12_BT601:
		case FAST_SDI_NV12_BT601_FR: 

		case FAST_SDI_422_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:
		{
			return 2;
		}
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT2020:
		{
			return 1;
		}

		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT601_FR:

		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		{
			return 2;
		}

		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:
				{
			return 1;
		}

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:
		{
			return 6;
		}

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		{
			return 4;
		}
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return 8;
		}
	}

	return 0;
}

inline unsigned long GetSDIHeightAlignValue(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_YV12_BT709:
		case FAST_SDI_YV12_BT2020:
		case FAST_SDI_YV12_BT601:
		case FAST_SDI_YV12_BT601_FR:

		case FAST_SDI_420_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_NV12_BT709:
		case FAST_SDI_NV12_BT2020:
		case FAST_SDI_NV12_BT601:
		case FAST_SDI_NV12_BT601_FR:
		{
			return 2;
		}

		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:

		case FAST_SDI_422_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_8_YCbCr_PLANAR_BT2020:

		case FAST_SDI_444_8_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_8_YCbCr_PLANAR_BT2020:
		{
			return 1;
		}

		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT601_FR:

		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		{
			return 2;
		}
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		{
			return 1;
		}

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return 1;
		}
	}

	return 0;
}

inline unsigned AlignSDIPitch(unsigned value, bool isHost) {
	if (!isHost)
		return uSnapUp(value, FAST_ALIGNMENT);
	return value;
}

inline bool IsPackedSDI(fastSDIFormat_t sdiFmt) {
	switch (sdiFmt) {
		case FAST_SDI_422_8_CbYCrY_BT601:
		case FAST_SDI_422_8_CbYCrY_BT601_FR:
		case FAST_SDI_422_8_CbYCrY_BT709:
		case FAST_SDI_422_8_CbYCrY_BT2020:

		case FAST_SDI_422_8_CrYCbY_BT601:
		case FAST_SDI_422_8_CrYCbY_BT601_FR:
		case FAST_SDI_422_8_CrYCbY_BT709:
		case FAST_SDI_422_8_CrYCbY_BT2020:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
		{
			return true;
		}
	}
	return false;
}

inline bool IsSDICopy3Format(fastSDIFormat_t _sdiFmt)
{
	return !IsPackedSDI(_sdiFmt);
}


inline fastSurfaceFormat_t GetSDISurfaceFormat(fastSDIFormat_t sdiFmt)
{
	switch (sdiFmt) {
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_444_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_420_10_MSBZ_YCbCr_PLANAR_BT601_FR:
		
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601_FR:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_LSBZ_YCbCr_PLANAR_BT2020:

		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT709:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT2020:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601:
		case FAST_SDI_422_10_MSBZ_YCbCr_PLANAR_BT601_FR:

		case FAST_SDI_422_10_CbYCrY_PACKED_BT601_FR:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT601:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT709:
		case FAST_SDI_422_10_CbYCrY_PACKED_BT2020:

		case FAST_SDI_P010_BT601_FR:
		case FAST_SDI_P010_BT601:
		case FAST_SDI_P010_BT709:
		case FAST_SDI_P010_BT2020:

		case FAST_SDI_RGB_10_BMR10L:
		case FAST_SDI_RGB_10_BMR10B:
		case FAST_SDI_RGB_12_BMR12B:
		case FAST_SDI_RGB_12_BMR12L:
			
			return FAST_RGB12;
		default:
			return FAST_RGB8;
	}
	return FAST_RGB8;
}
